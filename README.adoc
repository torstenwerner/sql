= SQL tutorial

== Preparation

* install docker → https://www.docker.com/[https://www.docker.com/] → Get Docker → For Desktops
* `docker run -d –name postgres -p 5432:5432 postgres:alpine`
* `echo 'create database sen;' | docker run -i –rm –link postgres:postgres postgres:alpine psql -h postgres -U postgres postgres`
* `docker run -i –rm –link postgres:postgres postgres:alpine psql -h postgres -U postgres sen &lt; world/world.sql`

Stop and start without losing data:

* `docker stop postgres`
* `docker start postgres`

== Checklist

everybody…
- got docker installed
- got postgresql set up
- got database tool configured and could execute the sample query
- has a Java IDE
- has opened the progress spreadsheet

== Exercises

=== SQL

* open the PostgreSQL documentation at https://www.postgresql.org/docs/9.6/static/index.html[https://www.postgresql.org/docs/9.6/static/index.html] and use it as needed
* The database contains some outdated world data about cities, countries, and languages.

Try to solve every task twice.
Use whatever you need e.g. views, temporarily tables to get is solved during the first try.
After that try to solve it again with exactly 1 but possibly complex statement without using views or temporary tables.

Tasks:

. Become familar with the 3 database tables. Execute some simple queries to understand the data.

. Check for each country if the language percentages add up to 100%. The result should look like:
+
[%autowidth,cols="<,>",options="header"]
|===
^|countrycode
^|sum

|BLZ|98.8
|BGD|98.69999
|ITA|99.59998
|===

. Calculate the rounded number of speakers of each language in each country. Sample output:
+
[%autowidth,cols="<,>,<",options="header"]
|===
^|name
^|speakers
^|language

|Afghanistan|11905280|Pashto
|Netherlands|15165984|Dutch
|Netherlands Antilles|187054|Papiamento
|===

. Calculate the rounded number of speakers of each language in the world. Sort them by speakers descending.
+
[%autowidth,cols=">,<",options="header"]
|===
^|speakers
^|language

|1191843539|Chinese
|405633085|Hindi
|355029462|Spanish
|===

. Calculate the world population.
+
[%autowidth,cols="<",options="header"]
|===
^|sum

|6078749450
|===

. List all country names that have no official languages.
+
[%autowidth,cols="<",options="header"]
|===
^|name

|Aruba
|Afghanistan
|Angola
|===

. Calculate world population, average, max and median population of all countries, europe's population, population of all countries below median.
+
[%autowidth,cols="<,<,<,<,<,<",options="header"]
|===
^|sum|average|max|median|europe|belowmedian

|6078749450|25434098|1277558000|3869000|730074600|101437250
|===

. Calculate number of cities per country, sort by city count descending.
+
[%autowidth,cols="<,>",options="header"]
|===
^|name|citycount

|China|363
|India|341
|United States|274
|===

. Convert the first 10 countries to a JSON array of country objects.
+
[%autowidth,cols="<",options="header"]
|===
^|json

|[{"code":"AFG","name":"Afghanistan"...}, ..., {"code":"ATG","name":"Antigua and Barbuda",...}]
|===
